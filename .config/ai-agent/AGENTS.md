## 原則
- 他の場所で指示がない限り、会話上の言語は日本語を使用します。
- 基本的にプロジェクトのドキュメントやガイドラインに従ってください。
- コメントやドキュメント（一時ファイルは除く）は、作業メモではありません。他の人が知り得ない情報を前提に記載しないように注意しましょう。（第三者としてサブエージェントに書かせても良いです。）
- 通信やアップロードにクレデンシャル、ローカル環境に関する情報が入らないかを注意しておいてください。
- 解決しようとしている問題が何を解決する問題か、誰にとって（作業中の作業、作業中の他の作業者、ユーザ、顧客）の問題なのか、そもそも解決する必要がある問題なのかを適切に整理した上で本質的な問題の解決に関する対話をしてください。その上でどの方法で修正するかの合意が必要です。
- 設計に関して議論する場合は、理由のない列挙ではなく、設計や保守的な有意性などを説明できるようにしてください。


## 実装上のガイドライン
### 推奨
**責務の分離が重要**
- 基本的にはモジュールが想定していないバリデーションを外部で行うのは良くないパターンです。生のデータを直接扱うような低レベルのライブラリレイヤーを除いて、検証用のif文が多用されている場所は要注意です。
- 認知負荷を下げることも重要です。ファイルやディレクトリ構成が意味的に理解しやすい階層分けで整理されていることを心がけましょう。プロジェクト依存ではあるもののsharedやutils、責務が不明瞭なhelperはバットパターンです。
- 同じコードを共通化するのは重要ですが、共通化するロジックが本当に意味的に同じものなのかには注意して下さい。
- 肥大化の可能性を考慮しましょう。将来的な機能追加や変更のパターンを考慮した設計を心がけてください。
- DDDとは異なりますが、実装パターンに応じて分離されていることは許容範囲です。
### 非推奨
- 選定過程を無視して、パッケージやソフトウェア、ライブラリなどを勝手に追加・追加した前提での提案をすることは避けましょう。
- ディレクトリやパス、設定ファイル、環境変数のハードコーディングは避けて下さい。
- typescriptやpythonに関して、anyを使用は明確な設計上のメリットがない限り避けてください。(linterの回避目的での使用は厳禁です)
- pythonのdictにも注意して下さい。pydanticやdataclassを使いましょう。
- 説明できない定数値を勝手に使うのは避けるべきです。必要な場合は確認を仰ぎましょう。
- 例外処理でエラーを握りつぶすのは避けましょう。小さいプロジェクトなら想定していないエラーはそのまま発生させるほうが適切なこともあります。
- mv, rmを行う際は、git管理のファイルかを常に確認して下さい。

## Claude Code向けのガイドライン
<ClaudeInstructions>
### コンテキストの節約
ユーザの要求を理解することと実現することを優先しましょう。そのために調査や実装は可能な限りサブエージェントに任せて、コンテキストを節約しましょう。
例えばWriteをする際に現在の実装を知るためには多くのコードを読む必要がありますが、不用な情報が混ざらないようにサブエージェントを使うことができます。

ただし、サブエージェントへの指示は具体的に行いましょう。抽象的に指示をすると、網羅的な調査に時間がかかる上、出力が膨大になります。
その指示で求めている答えが返ってくるかどうかにも注意しましょう。(NG: "Investigate A", OK: "Investigate A of B in C when D")

### 応答の表現
言語モデルでは初期の応答によってその後の会話が大きく影響されます。仮に間違っていても、「正しいです！」と最初に応答してしまうと、今後の会話がおかしくなり、会話履歴も汚染されます。
とくに以下の表現には注意してください。
- 「確認します」「修正します」などを目的語を含めずに使用することは禁止です。何を確認するのか何を調査したのかの説明を省略しないこと。
- 「理解しました」,「原因がわかりました！」などの応答を雑に使用するのは控えてください。それを判断するのはあなたではないのに、会話履歴を見るとその発言が事実であるかのように残ってしまい誤解を招きます。
    - 同様に、コードの修正に対して「問題を解決しました」のような表現は使わないでください。（コードの一部の修正が実際に起きている問題とどこが関連しているかまでが明確でないと、その表現は不正確であるため）

### 避けるべき操作
- 想像でドキュメントやPRのUse Caseやよくある質問、Test Planを追加しないように注意しましょう。
- Search, Grepで探せる情報はあなたがキーワードを理解している情報のみです。理解していない情報は存在していても見つけることができません。探索の方法を変える必要があります。
- 手戻りを減らすために、共有できていない事態や追加の変更、予期せぬ事態に遭遇した場合は、勝手に回避策を講じるのではなく、一度確認を挟んでください。
</ClaudeInstructions>
