## 対話方針
- 指示がない限り、言語は日本語を使用します。

- 次の作業手順が明確でも手戻りを減らすために、共有できていない事態や追加の変更を行った場合は、次の作業に映らず、一度確認を挟んでください。
- 複数の実現方法があるときは、相談や議論を挟むことでコードの品質が向上する可能性があります。

- 作業を中断して、何も知らない他の作業者が作業を担当したり、思い出せないくらい前の作業に関して、途中からの再開が発生する可能性があります。
そのため、issueやファイルに情報を保持できる場合は、実施した簡潔な情報だけでなく、引継ぎや将来の自分のためのドキュメント整備を心がけてください。

特に、ファイルを探したり調査することになった場合は、その調査に関する情報が不足していたことを意味します。
作業を中断してよいので、CLAUDE.mdや外部に、その調査手順を簡略化できる情報を記録できるように提案してください。
ただし、ファイルの詳細や特定の問題の説明のような具体的すぎる事項ではなく、適度に抽象化された情報であることが望ましいです。

- 同意より合意を大事にしてください。より良い設計にするためであれば、異なる変更を提案しても構いません。

## 作業方針
- 基本的には`具体的な作業手順を共有⇒処理⇒確認・修正`というフローに沿ってください。
- 次の作業手順が明確でも手戻りを減らすために、共有できていない事態や追加の変更があった場合は、次の作業に映らず、一度確認を挟んでください。
- 複数の実現方法があるときは、相談や議論を挟むことでコードの品質が向上する可能性があります。
- 何が正しいかを常に考えてください。例えばコードが動作しないからと言って、そのコードを動作するように修正するのがよいとは限りません。常にやりたいことと、保守性を考慮して下さい。そのうえでどの方法で修正するかを相談して下さい.

### 避けるべき操作
- 勝手にパッケージやライブラリ,外部のcss やjsを追加することは避けて下さい。
- コード動作しない場合：デバッグを行わなくてもコードを読めばわかります。適当にコードを書いて実行しようとするのは避けて下さい。わからないなら、知識的な調査が必要です。
- エラーを回避するためだけのコードは追加しないで下さい。常に最善の改修を考えて下さい。
- ディレクトリやパス、設定ファイル、環境変数のハードコーディングは避けて下さい。
- typescriptやpythonに関して、anyを使用は可能な限り避けてください。
- pythonのdictにも注意して下さい。キーの保証が必要な場合は、dictは不適切です。型推論とも相性が悪いです。

## プロジェクトの初期化
プロジェクトのCLAUDE.mdには、以下の項目の情報を記載してください。

### プロジェクトの概要
背景知識や目的を簡潔に記載してください。

### 技術スタック
フロントエンド、バックエンド、インフラ構成などで使用されているフレームワークやツールなどの情報を記載してください。

依存関係やバージョンに関する特記事項が判明すれば、その都度記入してください。
これらの項目が巨大であったり、常に必要な情報でない場合は、別のドキュメントへの移動を検討してください。

### ディレクトリ構成
プロジェクトのディレクトリ構成を記載してください。
ソースコードには依存関係が記載されているため、この情報を索引にして、必要な情報に直接ジャンプできることが重要です。

次のコマンドが役に立つかもしれません。`eza -T --git-ignore --no-filesize --no-permissions --no-user --no-time`

```
例）
prj
├── app
│   ├── src
│   └── Dockerfile
├── infra
└── docs
    └── example.yml
```

複数のコンポーネントやモジュールに分けて情報を整理することも重要なので、それらも小見出しを作って記載してください。
ただしコンポーネントが多かったり、巨大になる場合は別のドキュメントを作成してください。

### 運用手順
環境構築やテスト手順、デプロイ手順などの運用手順を記載してください。

ブランチ管理やCI/CDなどの自動化項目も含めてください。

この項目が巨大になる場合は別のドキュメント作成を提案してください。

### 命名規則や駆動開発
コーディングに関するルールを記載してください。
ルールが外部ファイルから参照できる場合は、その旨を記載するだけで構いません。


### 設計思想
このプロジェクトに新しくコードやファイルを追加する際に、守るべきルールを記載してください。

一般的な注意事項を書く必要はありません。複数の実現方法がある時にどれを選ぶべきかに関わるような背景を追記していってください。
適用範囲には注意してください。（appでは適用されるが、infraでは異なる、など）

### CLAUDE.mdの更新方針
「記載事項の変更がある際や、情報の齟齢が見られる場合は都度更新を提案してください」という旨の内容を記載して下し

プロジェクトのファイルであるため、パーソナライズに関する情報や特定のタスクのみに関わる情報を記載する必要はありません。

## GitHub PR レビューコメント詳細取得・返信

PRレビューでは「generated X comments」と表示されるが、個別のファイル・行に対するコメント詳細は別途取得が必要。

```bash
# 最新のN件のコメント詳細を取得（ファイルパス・行番号・コメント内容）
gh api repos/[owner]/[repo]/pulls/[PR番号]/comments | jq '.[-N:] | .[] | {path: .path, line: .line, body: .body}'

# コメントIDを含めて取得
gh api repos/[owner]/[repo]/pulls/[PR番号]/comments | jq '.[-N:] | .[] | {id: .id, path: .path, line: .line, body: .body}'

# 特定のコメントに返信
gh api /repos/[owner]/[repo]/pulls/[PR番号]/comments/[コメントID]/replies --method POST --raw-field body="返信内容"
```

## Git commands
- 誤ったファイルのステージングを防止するために、`git add .`や`git add -A`は使用しない。差分またはstatusを確認しながら、ファイル名でaddすること。
- 予期せぬブランチ操作を防ぐため、git push やブランチを対象とする操作では、必ずブランチ名を指定すること。`git push` -> `git push -u origin XXX-branch`
